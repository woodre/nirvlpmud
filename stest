#!/bin/sh
cd pfiles
echo 'Number of active players: ' `../../count_active */*.o`
echo ""
echo 'List of top players ' `date`
echo ""
echo "Name      Lev Experience Age"
echo ""
egrep '^level |^cap_name |^experience |^age ' */*.o |\
sed -e 's/\.o:/ /' -e 's/\"//g' |\
sort |\
awk '
$2=="age" { age = $3; }
$2=="experience" { experience = $3; }
$2=="cap_name" { name = $3; }
$2=="level" { if ($3 < 20) printf("%-10s %2d %2d %d\n", name, $3, experience, age/30/60);
	    experience = 0; name = "XX"; }' |\
sort +rn 1 2 |\
head -15
